<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grenfell Tower Curriculum Matching Activity</title>
    <style>
        :root {
            --red-border: #da291c;
            --blue-border: #0070c0;
            --correct-green: #d4edda;
            --correct-border: #28a745;
            --incorrect-red: #f8d7da;
            --incorrect-border: #dc3545;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9f9f9;
            /* Prevent full page scroll bounce on mobile for better drag experience */
            overscroll-behavior-y: contain; 
        }

        h1, p.intro {
            text-align: center;
            color: #333;
        }

        .game-container {
            display: flex;
            gap: 40px;
            /* vital: stretches the shorter column to match the taller one */
            align-items: stretch; 
            margin-top: 30px;
            /* Set a min-height to ensure decent spacing on large screens */
            min-height: 600px; 
        }

        .column {
            flex: 1; /* Both columns take equal width */
            display: flex;
            flex-direction: column;
            gap: 20px; /* Uniform gap between items */
        }

        .column-header {
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            font-size: 1.1em;
            flex: 0 0 auto; /* Header doesn't stretch */
        }

        /* --- Shared Styles for Uniformity --- */
        .card-style {
            padding: 20px;
            border-radius: 6px;
            /* Flex layout INSIDE the card to center text vertically */
            display: flex;
            align-items: center; 
            justify-content: flex-start; /* Keep text left aligned for readability */
            
            /* Vital: Makes every card share the column height equally */
            flex: 1; 
            width: 100%; /* Fill column width */
            box-sizing: border-box; /* Ensure padding doesn't affect width */
            font-size: 0.95rem;
            line-height: 1.4;
        }

        /* Draggable Items (Left Side) */
        .draggable-item {
            background: white;
            border: 3px solid var(--red-border);
            cursor: grab;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            transition: all 0.2s ease;
            user-select: none;
        }
        
        /* Apply shared layout style */
        .draggable-item {
            /* Inherit common flex properties */
            @extend .card-style; 
        }

        .draggable-item:active {
            cursor: grabbing;
            transform: scale(0.99);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .draggable-item.matched {
            opacity: 0.5;
            cursor: default;
            background-color: #e2e2e2;
            border-color: #ccc;
            text-decoration: line-through;
        }

        /* Drop Zones (Right Side) */
        .drop-zone {
            background: white;
            border: 3px solid var(--blue-border);
            transition: all 0.3s ease;
            position: relative;
        }

        /* Feedback States */
        .drop-zone.correct {
            background-color: var(--correct-green);
            border-color: var(--correct-border);
            color: #155724;
        }
        
        .drop-zone.correct::after {
            content: 'âœ” Match';
            position: absolute;
            top: -12px;
            right: -10px;
            background: var(--correct-border);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        .drop-zone.incorrect {
            animation: shake 0.5s;
            background-color: var(--incorrect-red);
            border-color: var(--incorrect-border);
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        /* Mobile Optimization */
        @media (max-width: 768px) {
            .game-container {
                flex-direction: column;
                /* On mobile, we don't want them to stretch endlessly, just stack */
                min-height: auto;
            }
            .card-style {
                /* On mobile, let content define height */
                flex: none; 
                min-height: 80px;
            }
        }
    </style>
</head>
<body>

    <h1>Matching Pairs: Grenfell Tower & Curriculum</h1>
    <p class="intro">Drag each Grenfell fact (red) to the Curriculum requirement (blue) that it might help to address.</p>

    <div class="game-container">
        
        <div class="column" id="left-col">
            <div class="column-header">Grenfell Facts</div>
            
            <div class="draggable-item card-style" draggable="true" id="drag1" data-match="target-dt">
                The flammability testing of the cladding materials which failed to predict the rapid spread of the fire.
            </div>

            <div class="draggable-item card-style" draggable="true" id="drag2" data-match="target-money">
                The repeated concerns raised by the Grenfell Action Group regarding fire safety that were overlooked by the Tenant Management Organisation.
            </div>

            <div class="draggable-item card-style" draggable="true" id="drag3" data-match="target-history">
                Locating the disaster within the historical context of North Kensington and social housing development.
            </div>

            <div class="draggable-item card-style" draggable="true" id="drag4" data-match="target-law">
                The breach of the residents' right to life and safe housing.
            </div>

            <div class="draggable-item card-style" draggable="true" id="drag5" data-match="target-community">
                The community-led response and the formation of support hubs by local residents immediately after the disaster.
            </div>
        </div>

        <div class="column" id="right-col">
            <div class="column-header">Curriculum Requirements</div>

            <div class="drop-zone card-style" id="target-dt">
                Investigate and analyse the work of past and present professionals and companies in the area of design and technology in order to help inform their own ideas. (GCSE Design and Technology)
            </div>

            <div class="drop-zone card-style" id="target-money">
                Income and expenditure, credit and debt, insurance, savings and pensions, financial products and services, and how public money is raised and spent. (KS4 Citizenship)
            </div>

            <div class="drop-zone card-style" id="target-law">
                The legal system in the UK, different sources of law and how the law helps society deal with complex problems. (KS4 Citizenship)
            </div>

            <div class="drop-zone card-style" id="target-history">
                A study of an aspect of history or a site dating from a period beyond 1066 that is significant in the locality. (KS2 History)
            </div>

            <div class="drop-zone card-style" id="target-community">
                The roles played by public institutions and voluntary groups in society, and the ways in which citizens work together to improve their communities. (KS3 Citizenship)
            </div>
        </div>
    </div>

    <script>
        // --- RANDOMIZER LOGIC ---
        function shuffleElements(containerId, itemClass) {
            const container = document.getElementById(containerId);
            // Get all items but exclude the header
            const header = container.querySelector('.column-header');
            const items = Array.from(container.querySelectorAll('.' + itemClass));

            // Fisher-Yates Shuffle Algorithm
            for (let i = items.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [items[i], items[j]] = [items[j], items[i]];
            }

            // Clear container (except header) and re-append
            // A safer way is to just append them in the new order, 
            // appendChild moves existing nodes.
            items.forEach(item => container.appendChild(item));
        }

        // Run Shuffle on Page Load
        window.addEventListener('DOMContentLoaded', () => {
            shuffleElements('left-col', 'draggable-item');
            shuffleElements('right-col', 'drop-zone');
        });

        // --- GAME LOGIC ---
        const draggables = document.querySelectorAll('.draggable-item');
        const dropZones = document.querySelectorAll('.drop-zone');

        draggables.forEach(draggable => {
            draggable.addEventListener('dragstart', dragStart);
        });

        dropZones.forEach(zone => {
            zone.addEventListener('dragover', dragOver);
            zone.addEventListener('drop', drop);
            zone.addEventListener('dragenter', dragEnter);
            zone.addEventListener('dragleave', dragLeave);
        });

        function dragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.id);
            e.dataTransfer.setData('match-id', e.target.getAttribute('data-match'));
            e.dataTransfer.effectAllowed = "move";
        }

        function dragOver(e) { e.preventDefault(); }

        function dragEnter(e) {
            e.preventDefault();
            const zone = e.target.closest('.drop-zone');
            if(zone && !zone.classList.contains('correct')) {
                zone.style.backgroundColor = "#f0f8ff";
            }
        }

        function dragLeave(e) {
            const zone = e.target.closest('.drop-zone');
            if(zone && !zone.classList.contains('correct') && 
               !zone.classList.contains('incorrect')) {
                zone.style.backgroundColor = "white";
            }
        }

        function drop(e) {
            e.preventDefault();
            const dropZone = e.target.closest('.drop-zone');
            
            // Safety check
            if (!dropZone || dropZone.classList.contains('correct')) return;

            const draggedId = e.dataTransfer.getData('text/plain');
            const requiredMatch = e.dataTransfer.getData('match-id');
            const draggedElement = document.getElementById(draggedId);

            if (dropZone.id === requiredMatch) {
                handleCorrect(dropZone, draggedElement);
            } else {
                handleIncorrect(dropZone);
            }
        }

        function handleCorrect(zone, draggedItem) {
            zone.classList.add('correct');
            zone.style.backgroundColor = ""; // Reset inline style
            
            draggedItem.classList.add('matched');
            draggedItem.setAttribute('draggable', 'false');
        }

        function handleIncorrect(zone) {
            zone.classList.add('incorrect');
            setTimeout(() => {
                zone.classList.remove('incorrect');
                zone.style.backgroundColor = "white";
            }, 600);
        }
    </script>
</body>
</html>
